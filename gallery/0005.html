
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Cosine+Spikes, Dirac-Cosine Basis, Gaussian Measurements &#8212; cr-sparse  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/custom.js"></script>
    <script src="../_static/js/mathconf.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Grassmannian Frames" href="grass.html" />
    <link rel="prev" title="Cosine+Spikes in Dirac-Cosine Basis" href="0003.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">cr-sparse</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=carnotresearch&repo=cr-sparse&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/index.html">API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sparse_vector_normals.html">A sparse model vector generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="0002.html">Blocks Signal in Haar Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="0004.html">Complex Sinusoids+Complex-Spikes in Dirac-Fourier Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="0003.html">Cosine+Spikes in Dirac-Cosine Basis</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Cosine+Spikes, Dirac-Cosine Basis, Gaussian Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="grass.html">Grassmannian Frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="0001.html">HeaviSine Signal in Fourier-HeaviSide Basis</a></li>
<li class="toctree-l2"><a class="reference internal" href="0006.html">Piecewise Cubic, Daubechies Basis, Gaussian Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="0007.html">Signed Spikes, Gaussian Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="0401.html">Source Separation I</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#linear-operators">Linear Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#compressive-sensing">Compressive Sensing</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#convex-relaxation-techniques">Convex Relaxation Techniques</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#data-clustering">Data Clustering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../zzzreference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Examples Gallery</a><ul>
      <li>Previous: <a href="0003.html" title="previous chapter">Cosine+Spikes in Dirac-Cosine Basis</a></li>
      <li>Next: <a href="grass.html" title="next chapter">Grassmannian Frames</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-gallery-0005-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="cosine-spikes-dirac-cosine-basis-gaussian-measurements">
<span id="gallery-0005"></span><span id="sphx-glr-gallery-0005-py"></span><h1>Cosine+Spikes, Dirac-Cosine Basis, Gaussian Measurements<a class="headerlink" href="#cosine-spikes-dirac-cosine-basis-gaussian-measurements" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#setup" id="id1">Setup</a></p></li>
<li><p><a class="reference internal" href="#sparse-recovery-using-subspace-pursuit" id="id2">Sparse Recovery using Subspace Pursuit</a></p></li>
<li><p><a class="reference internal" href="#sparse-recovery-using-compressive-sampling-matching-pursuit" id="id3">Sparse Recovery using Compressive Sampling Matching Pursuit</a></p></li>
<li><p><a class="reference internal" href="#sparse-recovery-using-spgl1" id="id4">Sparse Recovery using SPGL1</a></p></li>
<li><p><a class="reference internal" href="#comments" id="id5">Comments</a></p></li>
</ul>
</div>
<p>In this example we have</p>
<ol class="arabic simple">
<li><p>A signal <span class="math notranslate nohighlight">\(\by\)</span> consisting of a mixture of
3 cosine waves and 60 random spikes of total length 1024.</p></li>
<li><p>A Dirac-Cosine two ortho basis <span class="math notranslate nohighlight">\(\Psi\)</span> of shape 1024x2048.</p></li>
<li><p>The sparse representation <span class="math notranslate nohighlight">\(\bx\)</span> of the signal <span class="math notranslate nohighlight">\(\by\)</span>
in the basis <span class="math notranslate nohighlight">\(\Psi\)</span> consisting of exactly 63 nonzero
entries (corresponding to the spikes and the amplitudes of the cosine waves).</p></li>
<li><p>A Gaussian sensing matrix <span class="math notranslate nohighlight">\(\Phi\)</span> of shape  300x1024 making
300 random measurements in a vector <span class="math notranslate nohighlight">\(\bb\)</span>.</p></li>
<li><p>We are given <span class="math notranslate nohighlight">\(\bb\)</span> and <span class="math notranslate nohighlight">\(\bA = \Phi \Psi\)</span> and
have to reconstruct <span class="math notranslate nohighlight">\(\bx\)</span> using it.</p></li>
<li><p>Then we can use <span class="math notranslate nohighlight">\(\Psi\)</span> to compute <span class="math notranslate nohighlight">\(\by = \Psi \bx\)</span>.</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-gallery-0005-0">
<span class="eqno">(1)<a class="headerlink" href="#equation-gallery-0005-0" title="Permalink to this equation">¶</a></span>\[\bb = \bA \bx = \Phi \Psi \bx = \Phi \by.\]</div>
<p>See also:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../source/problems.html#api-problems"><span class="std std-ref">Test Problems</span></a></p></li>
<li><p><a class="reference internal" href="../source/lop.html#api-lop"><span class="std std-ref">Linear Operators</span></a></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure JAX to work with 64-bit floating point precision.</span>
<span class="kn">from</span> <span class="nn">jax.config</span> <span class="kn">import</span> <span class="n">config</span>
<span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s2">&quot;jax_enable_x64&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">cr.nimble</span> <span class="k">as</span> <span class="nn">crn</span>
<span class="kn">import</span> <span class="nn">cr.sparse.plots</span> <span class="k">as</span> <span class="nn">crplot</span>
</pre></div>
</div>
<section id="setup">
<h2><a class="toc-backref" href="#id1">Setup</a><a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h2>
<p>We shall construct our test signal and dictionary
using our test problems module.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cr.sparse</span> <span class="kn">import</span> <span class="n">problems</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">problems</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="s1">&#39;cosine-spikes:dirac-dct:gaussian&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <span class="n">problems</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_001.png" srcset="../_images/sphx_glr_0005_001.png" alt="Cosine with spikes, Cosine part of signal, Spikes part of signal, Dirac DCT Model, Measurements" class = "sphx-glr-single-img"/><p>Let us access the relevant parts of our test problem</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># The combined linear operator (sensing matrix + dictionary)</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">A</span>
<span class="c1"># The sparse representation of the signal in the dictionary</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">x</span>
<span class="c1"># The Cosine+Spikes signal</span>
<span class="n">y0</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">y</span>
<span class="c1"># The measurements</span>
<span class="n">b0</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">b</span>
</pre></div>
</div>
<p>Check how many coefficients in the sparse representation
are sufficient to capture 99.9% of the energy of the signal</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">crn</span><span class="o">.</span><span class="n">num_largest_coeffs_for_energy_percent</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="mf">99.9</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>37
</pre></div>
</div>
<p>This number gives us an idea about the required sparsity
to be configured for greedy pursuit algorithms.
Although the exact sparsity of this representation is 63
but several of the spikes are too small and could be ignored
for a reasonably good approximation.</p>
</section>
<section id="sparse-recovery-using-subspace-pursuit">
<h2><a class="toc-backref" href="#id2">Sparse Recovery using Subspace Pursuit</a><a class="headerlink" href="#sparse-recovery-using-subspace-pursuit" title="Permalink to this headline">¶</a></h2>
<p>We shall use subspace pursuit to reconstruct the signal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cr.sparse.pursuit.sp</span> <span class="k">as</span> <span class="nn">sp</span>

<span class="c1"># We will first try to estimate a 50-sparse representation</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>This utility function helps us quickly analyze the quality of reconstruction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problems</span><span class="o">.</span><span class="n">analyze_solution</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>m: 300, n: 2048
b_norm: original: 43.984 reconstruction: 43.982 SNR: 40.62 dB
x_norm: original: 47.155 reconstruction: 47.147 SNR: 39.24 dB
y_norm: original: 46.969 reconstruction: 46.986 SNR: 39.26 dB
Sparsity: original: 37, reconstructed: 36, overlap: 36, ratio: 0.973
Iterations: 20
</pre></div>
</div>
<p>We will now try to estimate a 75-sparse representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">problems</span><span class="o">.</span><span class="n">analyze_solution</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>m: 300, n: 2048
b_norm: original: 43.984 reconstruction: 43.984 SNR: 82.42 dB
x_norm: original: 47.155 reconstruction: 47.155 SNR: 79.39 dB
y_norm: original: 46.969 reconstruction: 46.969 SNR: 79.58 dB
Sparsity: original: 37, reconstructed: 37, overlap: 37, ratio: 1.000
Iterations: 10
</pre></div>
</div>
<p>Let us check if we correctly decoded all the nonzero entries
in the sparse representation x</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">problems</span><span class="o">.</span><span class="n">analyze_solution</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">sol</span><span class="p">,</span> <span class="n">perc</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>m: 300, n: 2048
b_norm: original: 43.984 reconstruction: 43.984 SNR: 82.42 dB
x_norm: original: 47.155 reconstruction: 47.155 SNR: 79.39 dB
y_norm: original: 46.969 reconstruction: 46.969 SNR: 79.58 dB
Sparsity: original: 63, reconstructed: 75, overlap: 62, ratio: 0.827
Iterations: 10
</pre></div>
</div>
<p>The estimated sparse representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<p>Let us reconstruct the signal from this sparse representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>The estimated measurements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us visualize the original and reconstructed representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_representations</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <span class="n">crplot</span><span class="o">.</span><span class="n">h_plots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original representation&#39;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reconstructed representation&#39;</span><span class="p">)</span>
<span class="n">plot_representations</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_002.png" srcset="../_images/sphx_glr_0005_002.png" alt="Original representation, Reconstructed representation" class = "sphx-glr-single-img"/><p>Let us visualize the original and reconstructed signal</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_signals</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <span class="n">crplot</span><span class="o">.</span><span class="n">h_plots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y0</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original signal&#39;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reconstructed signal&#39;</span><span class="p">)</span>
<span class="n">plot_signals</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_003.png" srcset="../_images/sphx_glr_0005_003.png" alt="Original signal, Reconstructed signal" class = "sphx-glr-single-img"/><p>Let us visualize the original and reconstructed measurements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_measurments</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <span class="n">crplot</span><span class="o">.</span><span class="n">h_plots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">b0</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original measurements&#39;</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reconstructed measurements&#39;</span><span class="p">)</span>
<span class="n">plot_measurments</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_004.png" srcset="../_images/sphx_glr_0005_004.png" alt="Original measurements, Reconstructed measurements" class = "sphx-glr-single-img"/></section>
<section id="sparse-recovery-using-compressive-sampling-matching-pursuit">
<h2><a class="toc-backref" href="#id3">Sparse Recovery using Compressive Sampling Matching Pursuit</a><a class="headerlink" href="#sparse-recovery-using-compressive-sampling-matching-pursuit" title="Permalink to this headline">¶</a></h2>
<p>We shall now use compressive sampling matching pursuit to reconstruct the signal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cr.sparse.pursuit.cosamp</span> <span class="k">as</span> <span class="nn">cosamp</span>
<span class="c1"># We will try to estimate a 75-sparse representation</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">cosamp</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
<span class="n">problems</span><span class="o">.</span><span class="n">analyze_solution</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">sol</span><span class="p">,</span> <span class="n">perc</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>m: 300, n: 2048
b_norm: original: 43.984 reconstruction: 43.984 SNR: 80.55 dB
x_norm: original: 47.155 reconstruction: 47.155 SNR: 76.81 dB
y_norm: original: 46.969 reconstruction: 46.969 SNR: 77.09 dB
Sparsity: original: 63, reconstructed: 75, overlap: 62, ratio: 0.827
Iterations: 57
</pre></div>
</div>
<p>The estimated sparse representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<p>Let us reconstruct the signal from this sparse representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>The estimated measurements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us visualize the original and reconstructed representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_representations</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_005.png" srcset="../_images/sphx_glr_0005_005.png" alt="Original representation, Reconstructed representation" class = "sphx-glr-single-img"/><p>Let us visualize the original and reconstructed signal</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_signals</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_006.png" srcset="../_images/sphx_glr_0005_006.png" alt="Original signal, Reconstructed signal" class = "sphx-glr-single-img"/><p>Let us visualize the original and reconstructed measurements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_measurments</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_007.png" srcset="../_images/sphx_glr_0005_007.png" alt="Original measurements, Reconstructed measurements" class = "sphx-glr-single-img"/></section>
<section id="sparse-recovery-using-spgl1">
<h2><a class="toc-backref" href="#id4">Sparse Recovery using SPGL1</a><a class="headerlink" href="#sparse-recovery-using-spgl1" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cr.sparse.cvx.spgl1</span> <span class="k">as</span> <span class="nn">crspgl1</span>
<span class="n">options</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class"><span class="n">crspgl1</span><span class="o">.</span><span class="n">SPGL1Options</span></a><span class="p">(</span><span class="n">max_iters</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">crspgl1</span><span class="o">.</span><span class="n">solve_bp_jit</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b0</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="n">problems</span><span class="o">.</span><span class="n">analyze_solution</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>m: 300, n: 2048
b_norm: original: 43.984 reconstruction: 43.984 SNR: 112.91 dB
x_norm: original: 47.155 reconstruction: 46.907 SNR: 35.83 dB
y_norm: original: 46.969 reconstruction: 46.781 SNR: 36.82 dB
Sparsity: original: 37, reconstructed: 34, overlap: 34, ratio: 0.919
Iterations: 861 n_times: 1522, n_trans: 862
</pre></div>
</div>
<p>The estimated sparse representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
<p>Let us reconstruct the signal from this sparse representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">prob</span><span class="o">.</span><span class="n">reconstruct</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>The estimated measurements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Let us visualize the original and reconstructed representation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_representations</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_008.png" srcset="../_images/sphx_glr_0005_008.png" alt="Original representation, Reconstructed representation" class = "sphx-glr-single-img"/><p>Let us visualize the original and reconstructed signal</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_signals</span><span class="p">(</span><span class="n">y0</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_009.png" srcset="../_images/sphx_glr_0005_009.png" alt="Original signal, Reconstructed signal" class = "sphx-glr-single-img"/><p>Let us visualize the original and reconstructed measurements</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_measurments</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_0005_010.png" srcset="../_images/sphx_glr_0005_010.png" alt="Original measurements, Reconstructed measurements" class = "sphx-glr-single-img"/></section>
<section id="comments">
<h2><a class="toc-backref" href="#id5">Comments</a><a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>With K=50, SP recovery is slightly inaccurate.
It also takes more (20) iterations to converge.</p></li>
<li><p>With K=75, SP is pretty good. It only missed one of the
63 nonzero entries. Also, SP converges in just 10 iterations.</p></li>
<li><p>With K=75, CoSaMP is also good but slightly poor. It also
missed just one nonzero entry. But it seems like it missed
a more significant entry compared to SP. Also, CoSaMP took
57 iterations to converge.</p></li>
<li><p>SPGL1 converges in 788 iterations to converge.
Its model space and signal space SNR are not good.
However, its measurement space SNR is pretty high.</p></li>
</ul>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 13.206 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-0005-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/bf80c2d14782022ccca9b56bb958a2af/0005.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">0005.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/510deb94352921a49a6df46594a3cdd9/0005.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">0005.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2021, CR-Suite Development Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/gallery/0005.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/carnotresearch/cr-sparse" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-214289683-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>